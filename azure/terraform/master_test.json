{
    "testSet": [
        {
            "masterTestName": "AZURE_terraform_TEST",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "TEST_AKS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0006-TRF",
                            "eval": "data.rule.aks_cni_net",
                            "message": "data.rule.aks_cni_net_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0007-TRF",
                            "eval": "data.rule.aks_http_routing",
                            "message": "data.rule.aks_http_routing_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0008-TRF",
                            "eval": "data.rule.aks_monitoring",
                            "message": "data.rule.aks_monitoring_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0009-TRF",
                            "eval": "data.rule.aks_nodes",
                            "message": "data.rule.aks_nodes_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0010-TRF",
                            "eval": "data.rule.aks_rbac",
                            "message": "data.rule.aks_rbac_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure AKS cluster configuration check.",
                    "description": "Azure AKS cluster Azure CNI networking is enabled. Azure AKS cluster HTTP application routing should be enabled. Azure AKS cluster monitoring should be enabled. Azure AKS cluster pool profile count contains less than 3 nodes. Azure AKS enable role-based access control (RBAC) is enforced.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_APPLICATION_GATEWAYS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(applicationgateways.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0011-TRF",
                            "eval": "data.rule.gw_tls",
                            "message": "data.rule.gw_tls_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0012-TRF",
                            "eval": "data.rule.gw_waf",
                            "message": "data.rule.gw_waf_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure Application Gateway configurtaion check.",
                    "description": "Azure Application Gateway allows TLSv1.1 or lower.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_DB_ADMINISTRATORS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(dbadministrators.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0085-TRF",
                            "eval": "data.rule.db_ad_admin",
                            "message": "data.rule.db_ad_admin_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure SQL DB Administrator check.",
                    "description": "SQL servers which do not have Azure Active Directory admin configured.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": ["CSA CCM","ISO 27001","NIST","PCI DSS"],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_DB_AUDITING_DB_SETTINGS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(dbauditingdbsettings.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0003-TRF",
                            "eval": "data.rule.mssql_db_log_auditt",
                            "message": "data.rule.mssql_db_log_audit_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0053-TRF",
                            "eval": "data.rule.mssql_db_log_retention",
                            "message": "data.rule.mssql_db_log_retention_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure SQL DB Auditing DB Settings.",
                    "description": "Auditing for SQL database should be set to On. Azure SQL Database with Auditing Retention less than 90 days.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },{
                    "masterTestId": "TEST_DB_AUDITING_SETTINGS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(dbauditingsettings.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0059-TRF",
                            "eval": "data.rule.mssql_log_retention",
                            "message": "data.rule.mssql_log_retention_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure SQL Server audit log retention is less than 91 days",
                    "description": "Audit Logs can help you find suspicious events, unusual activity, and trends. Auditing the SQL server, at the server-level, allows you to track all existing and newly created databases on the instance._x000D__x000D_This policy identifies SQL servers which do not retain audit logs for more than 90 days. As a best practice, configure the audit logs retention time period to be greater than 90 days.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_DB_FIREWALL_RULES",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(dbfirewallrules.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0082-TRF",
                            "eval": "data.rule.db_firewall",
                            "message": "data.rule.db_firewall_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure SQL DB Firewall Rules.",
                    "description": "SQL Server Firewall rules allow access to any Azure internal resources.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": ["CIS","CSA CCM","ISO 27001","NIST","PCI DSS"],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_DB_SECURITY_ALERTS_POLICIES",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(dbsecurityalertpolicies.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0054-TRF",
                            "eval": "data.rule.dbsec_threat_retention",
                            "message": "data.rule.dbsec_threat_retention_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0055-TRF",
                            "eval": "data.rule.dbsec_threat_email",
                            "message": "data.rule.dbsec_threat_email_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0097-TRF",
                            "eval": "data.rule.dbsec_threat_alert",
                            "message": "data.rule.dbsec_threat_alert_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0088-TRF",
                            "eval": "data.rule.sql_alert",
                            "message": "data.rule.sql_alert_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0096-TRF",
                            "eval": "data.rule.dbsec_threat_off",
                            "message": "data.rule.dbsec_threat_off_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure SQL DB Security Alert Policy.",
                    "description": "Azure SQL DB with Threat Retention less than 91 days. Azure SQL DB with disabled Email service and co-administrators for Threat Detection. Azure SQL Server threat detection alerts not enabled for all threat types. Send alerts on field value on SQL Databases is misconfigured. Threat Detection on SQL databases is set to Off. ",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_DB_VALENRABILITY_ASSESSMENTS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(dbvulnerabilityassessments.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0056-TRF",
                            "eval": "data.rule.db_ads_mail",
                            "message": "data.rule.db_ads_mail_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0057-TRF",
                            "eval": "data.rule.db_ads_alert",
                            "message": "data.rule.db_ads_alert_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0058-TRF",
                            "eval": "data.rule.db_ads_scan",
                            "message": "data.rule.db_ads_scan_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure DB vulnerability Assessments.",
                    "description": "Azure SQL Server advanced data security does not have an email alert recipient. Azure SQL Server advanced data security does not send alerts to service and co-administrators. Azure SQL Server advanced data security is disabled.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_KEYVAULT_SECRETS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(keyvaultsecrets.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0018-TRF",
                            "eval": "data.rule.kv_expire",
                            "message": "data.rule.kv_expire_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure Key Vault Secrets.",
                    "description": "Azure Key Vault secrets have no expiration date.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_NETWORK_SECURITY_GROUP",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0022-TRF",
                            "eval": "data.rule.nsg_in_tcp_all_src",
                            "message": "data.rule.nsg_in_tcp_all_src_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0023-TRF",
                            "eval": "data.rule.nsg_in_udp_all_src",
                            "message": "data.rule.nsg_in_udp_all_src_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0024-TRF",
                            "eval": "data.rule.nsg_in_tcp_all",
                            "message": "data.rule.nsg_in_tcp_all_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0025-TRF",
                            "eval": "data.rule.nsg_in_udp_all",
                            "message": "data.rule.nsg_in_udp_all_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0026-TRF",
                            "eval": "data.rule.nsg_in_all",
                            "message": "data.rule.nsg_in_all_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0027-TRF",
                            "eval": "data.rule.nsg_in_all_src",
                            "message": "data.rule.nsg_in_all_src_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0028-TRF",
                            "eval": "data.rule.nsg_in_all_dst",
                            "message": "data.rule.nsg_in_all_dst_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0034-TRF",
                            "eval": "data.rule.nsg_allow_icmp",
                            "message": "data.rule.nsg_allow_icmp_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0032-TRF",
                            "eval": "data.rule.inbound_port_21",
                            "message": "data.rule.inbound_port_21_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"gID3",
                            "eval": "data.rule.inbound_insecure_port",
                            "message": "data.rule.inbound_insecure_port_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"gID5",
                            "eval": "data.rule.inbound_port_11211",
                            "message": "data.rule.inbound_port_11211_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"gID7",
                            "eval": "data.rule.inbound_port_6379",
                            "message": "data.rule.inbound_port_6379_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"gID6",
                            "eval": "data.rule.inbound_port_dbs",
                            "message": "data.rule.inbound_port_dbs_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0020-TRF",
                            "eval": "data.rule.inbound_port_22",
                            "message": "data.rule.inbound_port_22_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0021-TRF",
                            "eval": "data.rule.inbound_port_3389",
                            "message": "data.rule.inbound_port_3389_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0047-TRF",
                            "eval": "data.rule.inbound_port_445",
                            "message": "data.rule.inbound_port_445_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0031-TRF",
                            "eval": "data.rule.inbound_port_53",
                            "message": "data.rule.inbound_port_53_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0033-TRF",
                            "eval": "data.rule.inbound_port_20",
                            "message": "data.rule.inbound_port_20_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0035-TRF",
                            "eval": "data.rule.inbound_port_4333",
                            "message": "data.rule.inbound_port_4333_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0036-TRF",
                            "eval": "data.rule.inbound_port_3306",
                            "message": "data.rule.inbound_port_3306_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0038-TRF",
                            "eval": "data.rule.inbound_port_netbios",
                            "message": "data.rule.inbound_port_netbios_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0039-TRF",
                            "eval": "data.rule.inbound_port_5432",
                            "message": "data.rule.inbound_port_5432_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0040-TRF",
                            "eval": "data.rule.inbound_port_25",
                            "message": "data.rule.inbound_port_25_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0042-TRF",
                            "eval": "data.rule.inbound_port_sqlserver",
                            "message": "data.rule.inbound_port_sqlserver_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0043-TRF",
                            "eval": "data.rule.inbound_port_23",
                            "message": "data.rule.inbound_port_23_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0044-TRF",
                            "eval": "data.rule.inbound_port_5500",
                            "message": "data.rule.inbound_port_5500_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0045-TRF",
                            "eval": "data.rule.inbound_port_5900",
                            "message": "data.rule.inbound_port_5900_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0046-TRF",
                            "eval": "data.rule.inbound_port_135",
                            "message": "data.rule.inbound_port_135_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0048-TRF",
                            "eval": "data.rule.nsg_out_all",
                            "message": "data.rule.nsg_out_all_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"gID1",
                            "eval": "data.rule.outbound_port_bitcoin",
                            "message": "data.rule.outbound_port_bitcoin_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"gID2",
                            "eval": "data.rule.outbound_port_ethereum",
                            "message": "data.rule.outbound_port_ethereum_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure Network Security Group.",
                    "description": "Check for allowed inbound and outbound ports in network security group.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_PRICING",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(pricing.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0091-TRF",
                            "eval": "data.rule.pricing",
                            "message": "data.rule.pricing_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure Pricing.",
                    "description": "Standard pricing tier is not selected in Security Center.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": ["CIS","ISO 27001"],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_REGISTRIES_LIST",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(registrieslist.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0015-TRF",
                            "eval": "data.rule.acr_classic",
                            "message": "data.rule.acr_classic_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        
                        }
                    ],
                    "title": "Azure Registries List.",
                    "description": "Azure Container Registry using the deprecated classic registry.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_REGISTRIES_WEBHOOK",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(registrieswebhooks.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0005-TRF",
                            "eval": "data.rule.acr_webhooks",
                            "message": "data.rule.acr_webhooks_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure Registries Webhook.",
                    "description": "Azure ACR HTTPS not enabled for webhook.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_SECURITY_CONTACTS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0087-TRF",
                            "eval": "data.rule.securitycontacts",
                            "message": "data.rule.securitycontacts_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure security contacts.",
                    "description": "Security contact emails is not set in Security Center.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": ["CIS","CSA CCM","HIPAA","ISO 27001","NIST","PCI DSS"],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_STORAGE_ACCOUNT",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0092-TRF",
                            "eval": "data.rule.storage_secure",
                            "message": "data.rule.storage_secure_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        },
                        {
                            "id":"PR-AZR-0093-TRF",
                            "eval": "data.rule.storage_acl",
                            "message": "data.rule.storage_acl_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure storage contacts.",
                    "description": "Storage Accounts without Secure transfer enabled. Storage Accounts without their firewalls enabled.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_STORAGE_BLOB_CONTAINER",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(storageblobcontainers.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0013-TRF",
                            "eval": "data.rule.storage_public_access",
                            "message": "data.rule.storage_public_access_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure storage blob container.",
                    "description": "Azure Blob container(s) with public access and logging set to less than 180 days.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                },
                {
                    "masterTestId": "TEST_VNET_PEERINGS",
                    "masterSnapshotId": [
                        "TRF_TEMPLATE_SNAPSHOT"
                    ],
                    "type": "rego",
                    "rule": "file(vnetsubnets.rego)",
                    "evals": [
                        {
                            "id":"PR-AZR-0067-TRF",
                            "eval": "data.rule.vnet_subnet_nsg",
                            "message": "data.rule.vnet_subnet_nsg_err",
                            "remediationDescription":"",
                            "remediationFunction":""
                        }
                    ],
                    "title": "Azure virtual network peering.",
                    "description": "Azure virtual network peer is disconnected.",
                    "tags": [
                        {
                            "cloud": "git",
                            "compliance": [],
                            "service": []
                        }
                    ]
                }
            ]
        }
    ]
}