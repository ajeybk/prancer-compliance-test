{
    "testSet": [
        {
            "masterTestName": "AZURE_Cloud_TEST",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "AZURE_TEST_KV_01",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-001",
                            "eval": "data.rule.KeyVault",
                            "message": "data.rule.KeyVault_err",
                            "remediationDescription": "1. Go to 'Key vaults' and choose your Key Vault<br>2. Select 'Keys/Secrets/Certificates' under 'Settings' in the navigation menu<br>3. Select 'Generate/Import' and complete the wizard.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices",
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "Low",
                    "title": "Ensure that keyvault is in use",
                    "description": "Use the Azure Key Vault to store secrets within the Microsoft Azure environment. Secrets in Azure Key Vault are octet sequences with a maximum size of 25k bytes each."
                },
                {
                    "masterTestId": "AZURE_TEST_KV_02",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-002",
                            "eval": "data.rule.enableSoftDelete",
                            "message": "data.rule.enableSoftDelete_err",
                            "remediationDescription": "Via Azure Portal<br>Azure Portal does not have provision to update the respective configurations<br><br>Via Azure CLI<br>Existing key vault:<br><br>For an existing key vault named ContosoVault, enable soft-delete as follows:<br><br>az resource update --id $(az keyvault show --name ContosoVault -o tsv , awk '{print $1}') --set properties.enableSoftDelete=true.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "High",
                    "title": "Ensure the key vault is recoverable - enable 'Soft Delete' setting for a Key Vault",
                    "description": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the key vault objects. It is recommended the key vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user."
                },
                {
                    "masterTestId": "AZURE_TEST_KV_03",
                    "type": "rego",
                    "rule": "file(Keyvault.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-003",
                            "eval": "data.rule.enablePurgeProtection",
                            "message": "data.rule.enablePurgeProtection_err",
                            "remediationDescription": "Via Azure Portal<br>Azure Portal does not have provision to update the respective configurations<br><br>Via Azure CLI<br>Existing key vault:<br><br>For an existing key vault named ContosoVault, enable soft-delete as follows:<br><br>az resource update --id $(az keyvault show --name ContosoVault -o tsv , awk '{print $1}') --set properties.enableSoftDelete=true.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_228"
                    ],
                    "severity": "High",
                    "title": "Key vault should have purge protection enabled",
                    "description": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation"
                },
                {
                    "masterTestId": "AZURE_TEST_KV_04",
                    "type": "rego",
                    "rule": "file(KeyvaultKey.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-004",
                            "eval": "data.rule.kv_expire",
                            "message": "data.rule.kv_expire_err",
                            "remediationDescription": "1. Go to 'Key vaults' and choose your Key Vault<br>2. Select 'Keys' under 'Settings' in the navigation menu<br>3. Select the relevant key and reselect its current version<br>3. Check 'Set expiration date'<br>4. Save.<br>Please visit <a href='https://docs.microsoft.com/en-us/cli/azure/keyvault?view=azure-cli-latest' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_229"
                    ],
                    "severity": "High",
                    "title": "Azure Key Vault secrets should have an expiration date",
                    "description": "This policy identifies Azure Key Vault secrets that do not have an expiration date. As a best practice, set an expiration date for each secret and rotate the secret regularly."
                },
                {
                    "masterTestId": "AZURE_TEST_KV_05",
                    "type": "rego",
                    "rule": "file(KeyvaultSecrets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-KV-005",
                            "eval": "data.rule.kv_expire",
                            "message": "data.rule.kv_expire_err",
                            "remediationDescription": "1. Go to Key vaults<br>2. For each Key vault, click on Secrets.<br>3. Ensure that each secret in the vault has EXPIRATION DATE set as appropriate.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/keyvault/vaults/get' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_KV_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_227"
                    ],
                    "severity": "High",
                    "title": "Azure Key Vault secrets should have an expiration date",
                    "description": "This policy identifies Azure Key Vault secrets that do not have an expiration date. As a best practice, set an expiration date for each secret and rotate the secret regularly."
                },
                {
                    "masterTestId": "AZURE_TEST_STR_03",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-003",
                            "eval": "data.rule.storage_secure",
                            "message": "data.rule.storage_secure_err",
                            "remediationDescription": "1. Go to 'Storage accounts' and choose your storage account<br>2. Select 'Configuration' under 'Settings' in the navigation menu<br>3. Set 'Secure transfer required' to 'Enabled'<br>4. Save.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/storagerp/storage-accounts/get-properties' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_003.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts https based secure transfer should be enabled",
                    "description": "The secure transfer option enhances the security of your storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access your storage accounts, you must connect using HTTPs. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When you are using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesnâ€™t support HTTPs for custom domain names, this option is not applied when using a custom domain name.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_04",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-004",
                            "eval": "data.rule.storage_acl",
                            "message": "data.rule.storage_acl_err",
                            "remediationDescription": "1. Go to Storage Accounts<br>2. For each storage account, Click on the settings menu called Firewalls and virtual networks.<br>3. Ensure that you have selected to allow access from Selected networks.<br>4. Add rules to allow traffic from specific network.<br>5. Click Save to apply your changes.<br>Azure Command Line Interface 2.0 Use the below command to update default-action to Deny.<br>Please visit <a href='https://docs.microsoft.com/en-us/rest/api/storagerp/storage-accounts/get-properties' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_004.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts should have firewall rules enabled",
                    "description": "Turning on firewall rules for your storage account blocks incoming requests for data by default, unless the requests come from a service that is operating within an Azure Virtual Network (VNet). Requests that are blocked include those from other Azure services, from the Azure portal, from logging and metrics services, and so on.<br><br>You can grant access to Azure services that operate from within a VNet by allowing the subnet of the service instance. Enable a limited number of scenarios through the Exceptions mechanism described in the following section. To access the Azure portal, you would need to be on a machine within the trusted boundary (either IP or VNet) that you set up.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_06",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-006",
                            "eval": "data.rule.blobService",
                            "message": "data.rule.blobService_err",
                            "remediationDescription": "Currently, Storage account supports customer-managed keys encryption for blobs by default upon account creation, this cannot be changed after.<br>Note: When customer-managed keys are configured, your data in Blob storage and Azure Files is automatically protected using the customer-managed keys.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_006.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that 'Storage service encryption' is enabled for the Blob Service",
                    "description": "Enable data encryption at rest for blobs. Storage service encryption protects your data at rest. Azure Storage encrypts data when it's written, and automatically decrypts it when it is accessed.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_07",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-007",
                            "eval": "data.rule.fileService",
                            "message": "data.rule.fileService_err",
                            "remediationDescription": "Currently, Storage account supports customer-managed keys encryption for files by default upon account creation, this cannot be changed after.<br>Note: When customer-managed keys are configured, your data in Blob storage and Azure Files is automatically protected using the customer-managed keys.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_007.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that 'Storage service encryption' is enabled for the File Service",
                    "description": "Azure Storage encryption protects your data and to help you to meet your organizational security and compliance commitments. Data in Azure Storage is encrypted and decrypted transparently using 256-bit AES encryption, one of the strongest block ciphers available, and is FIPS 140-2 compliant. Azure Storage encryption is similar to BitLocker encryption on Windows.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_08",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-008",
                            "eval": "data.rule.keySource",
                            "message": "data.rule.keySource_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_008.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure critical data storage in Storage Account is encrypted with Customer Managed Key",
                    "description": "By default, data in the storage account is encrypted using Microsoft Managed Keys at rest. All Azure Storage resources are encrypted, including blobs, disks, files, queues, and tables. All object metadata is also encrypted. However, if you want to control and manage this encryption key yourself, you can specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. You can also choose to automatically update the key version used for Azure Storage encryption whenever a new version is available in the associated Key Vault.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_09",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "GDPR"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-009",
                            "eval": "data.rule.region",
                            "message": "data.rule.region_err",
                            "remediationDescription": "Please refer to Azure documentations about Storage Accounts:<br><a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account' target='_blank'>here</a>.<br>and<br>Azure documentations about Regions:<br><a href='https://azure.microsoft.com/en-us/global-infrastructure/regions/#services' target='_blank'>here</a>",
                            "remediationFunction": "PR_AZR_STR_009.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Storage Accounts location configuration should be inside of Europe",
                    "description": "Identify Storage Accounts outside of the following regions: northeurope, westeurope",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_10",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-010",
                            "eval": "data.rule.blobServicePublicAccessDisabled",
                            "message": "data.rule.blobServicePublicAccessDisabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_010.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Ensure that Storage Account should not allow public access to all blobs or containers",
                    "description": "Identify Storage Accounts outside of the following regions: northeurope, westeurope",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_STR_11",
                    "type": "rego",
                    "rule": "file(storageaccounts.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "evals": [
                        {
                            "id": "PR-AZR-STR-011",
                            "eval": "data.rule.storage_acount_by_pass",
                            "message": "data.rule.storage_acount_by_pass_err",
                            "remediationDescription": "1. Go to Storage Accounts<br>2. For each storage account, Click on the settings menu called Firewalls and virtual networks.<br>3. Ensure that you have elected to allow access from 'Selected networks'.<br>4. Enable check box for Allow trusted Microsoft services to access this storage account.<br>5. Click Save to apply your changes.<br>Azure Command Line Interface 2.0 Use the below command to update trusted Microsoft services.<br>Please visit <a href='https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security' target='_blank'>here</a> for details.",
                            "remediationFunction": "PR_AZR_STR_011.py"
                        }
                    ],
                    "severity": "High",
                    "title": "Azure Storage Account Trusted Microsoft Services access should be enabled",
                    "description": "Specifies whether traffic is bypassed for Logging/Metrics/AzureServices. Possible values are any combination of Logging, Metrics, AzureServices (For example, 'Logging, Metrics'), or None to bypass none of those traffics. - None, Logging, Metrics, AzureServices.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_1",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-001",
                            "eval": "data.rule.https_only",
                            "message": "data.rule.https_only_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure App Service Web App enforce https connection",
                    "description": "Azure Web Apps by default allows sites to run under both HTTP and HTTPS, and can be accessed by anyone using non-secure HTTP links. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. We recommend you enforce HTTPS-only traffic to increase security. This will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the SSL/TLS protocol to provide a secure connection, which is both encrypted and authenticated."
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_2",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-002",
                            "eval": "data.rule.min_tls_version",
                            "message": "data.rule.min_tls_version_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Web App should uses the latest version of TLS encryption",
                    "description": "App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. For secure web app connections it is highly recommended to only use the latest TLS 1.2 version."
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_3",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-003",
                            "eval": "data.rule.client_cert_enabled",
                            "message": "data.rule.client_cert_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Web App should has incoming client certificates enabled",
                    "description": "Client certificates allow the Web App to require a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app. The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app."
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_4",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-004",
                            "eval": "data.rule.http_20_enabled",
                            "message": "data.rule.http_20_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Web App should uses the latest version of HTTP",
                    "description": "We recommend you use the latest HTTP version for web apps and take advantage of any security fixes and new functionalities featured. With each software installation you can determine if a given update meets your organization's requirements. Organizations should verify the compatibility and support provided for any additional software, assessing the current version against the update revision being considered."
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_6",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-006",
                            "eval": "data.rule.web_service_cors_not_allowing_all",
                            "message": "data.rule.web_service_cors_not_allowing_all_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "High",
                    "title": "Ensure CORS configuration is not allowing every resources to access Azure Web Service",
                    "description": "This policy will identify CORS configuration which are allowing every resoruces to access Azure Web service and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_7",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-007",
                            "eval": "data.rule.web_service_http_logging_enabled",
                            "message": "data.rule.web_service_http_logging_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service http logging should be enabled",
                    "description": "This policy will identify the Azure Web service which dont have http logging enabled and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_8",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-008",
                            "eval": "data.rule.web_service_detaild_error_message_enabled",
                            "message": "data.rule.web_service_detaild_error_message_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service detaild error message should be enabled",
                    "description": "This policy will identify the Azure Web service which dont have detaild error message enabled and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_9",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-009",
                            "eval": "data.rule.web_service_request_tracing_enabled",
                            "message": "data.rule.web_service_request_tracing_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service request tracing should be enabled",
                    "description": "This policy will identify the Azure web service which dont have request tracing enabled and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_10",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-010",
                            "eval": "data.rule.web_service_managed_identity_provider_enabled",
                            "message": "data.rule.web_service_managed_identity_provider_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Managed Identity provider should be enabled",
                    "description": "This policy will identify the Azure Web service which dont have Managed Identity provider enabled and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_11",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-011",
                            "eval": "data.rule.web_service_remote_debugging_disabled",
                            "message": "data.rule.web_service_remote_debugging_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service remote debugging should be disabled",
                    "description": "This policy will identify the Azure web service which have remote debugging enabled and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_12",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-012",
                            "eval": "data.rule.web_service_ftp_deployment_disabled",
                            "message": "data.rule.web_service_ftp_deployment_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service FTP deployments should be disabled",
                    "description": "This policy will identify the Azure web service which have FTP deployment enabled and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_13",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-013",
                            "eval": "data.rule.web_service_net_framework_latest",
                            "message": "data.rule.web_service_net_framework_latest_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Dot Net Framework should be latest",
                    "description": "This policy will identify the Azure web service which dont have latest version of Net Framework and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_14",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-014",
                            "eval": "data.rule.web_service_php_version_latest",
                            "message": "data.rule.web_service_php_version_latest_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service PHP version should be latest",
                    "description": "This policy will identify the Azure web service which dont have latest version of PHP and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_WEB_15",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-015",
                            "eval": "data.rule.web_service_python_version_latest",
                            "message": "data.rule.web_service_python_version_latest_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_015.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Pyhton version should be latest",
                    "description": "This policy will identify the Azure web service which dont have latest version of Pyhton and give alert"
                },  
                {
                    "masterTestId": "AZURE_TEST_WEB_16",
                    "type": "rego",
                    "rule": "file(appService.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-WEB-016",
                            "eval": "data.rule.web_service_java_version_latest",
                            "message": "data.rule.web_service_java_version_latest_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_WEB_016.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_100"
                    ],
                    "severity": "Medium",
                    "title": "Azure Web Service Java version should be latest",
                    "description": "This policy will identify the Azure web service which dont have latest version of Java and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_12",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-012",
                            "eval": "data.rule.maria_ingress_from_any_ip_disabled",
                            "message": "data.rule.maria_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_408"
                    ],
                    "severity": "High",
                    "title": "MariaDB should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify MariaDB firewall rule that are currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_13",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-013",
                            "eval": "data.rule.dbmaria_ingress_from_any_ip_disabled",
                            "message": "data.rule.dbmaria_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "High",
                    "title": "MariaDB should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify MariaDB firewall rule that are currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_14",
                    "type": "rego",
                    "rule": "file(dbforMySQL_firewallrules.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-014",
                            "eval": "data.rule.mysql_ingress_from_any_ip_disabled",
                            "message": "data.rule.mysql_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_410"
                    ],
                    "severity": "High",
                    "title": "MySQL Database Server should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify MySQL Database Server firewall rule that are currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_15",
                    "type": "rego",
                    "rule": "file(dbforMySQL_firewallrules.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-015",
                            "eval": "data.rule.my_logical_sql_ingress_from_any_ip_disabled",
                            "message": "data.rule.my_logical_sql_ingress_from_any_ip_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_015.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "High",
                    "title": "MySQL Database Server should not allow ingress from all Azure-internal IP addresses (0.0.0.0/0)",
                    "description": "This policy will identify MySQL Database Server firewall rule that are currently allowing ingress from all Azure-internal IP addresses"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_16",
                    "type": "rego",
                    "rule": "file(dbforMySQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-016",
                            "eval": "data.rule.ssl_enforcement",
                            "message": "data.rule.ssl_enforcement_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_016.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "High",
                    "title": "Ensure ssl enforcement is enabled on MySQL server Database Server.",
                    "description": "Enable SSL connection on MySQL Servers databases. Rationale: SSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_60",
                    "type": "rego",
                    "rule": "file(dbforMySQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-060",
                            "eval": "data.rule.mysql_public_access_disabled",
                            "message": "data.rule.mysql_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_060.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "High",
                    "title": "Ensure MySQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for Azure MySQL Database Server"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_61",
                    "type": "rego",
                    "rule": "file(dbforMySQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-061",
                            "eval": "data.rule.mysql_server_latest_tls_configured",
                            "message": "data.rule.mysql_server_latest_tls_configured_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_061.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_411"
                    ],
                    "severity": "High",
                    "title": "Ensure Azure MySQL Server has latest version of tls configured",
                    "description": "This policy will identify the Azure MySQL Server which dont have latest version of tls configured and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_56",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-056",
                            "eval": "data.rule.mairadb_ssl_enforcement_enabled",
                            "message": "data.rule.mairadb_ssl_enforcement_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_056.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "High",
                    "title": "Ensure ssl enforcement is enabled on MariaDB Server.",
                    "description": "Enable SSL connection on MariaDB Servers. Rationale: SSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_57",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-057",
                            "eval": "data.rule.mairadb_public_access_disabled",
                            "message": "data.rule.mairadb_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_057.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "High",
                    "title": "Ensure MariaDB servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for MariaDB Server"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_58",
                    "type": "rego",
                    "rule": "file(dbforMariaDB.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-058",
                            "eval": "data.rule.mariadb_geo_redundant_backup_enabled",
                            "message": "data.rule.mariadb_geo_redundant_backup_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_058.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_409"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Geo-redundant backup is enabled on MariaDB server.",
                    "description": "Azure Database for MariaDB provides the flexibility to choose between locally redundant or geo-redundant backup storage in the General Purpose and Memory Optimized tiers. When the backups are stored in geo-redundant backup storage, they are not only stored within the region in which your server is hosted, but are also replicated to a paired data center. This provides better protection and ability to restore your server in a different region in the event of a disaster. The Basic tier only offers locally redundant backup storage."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_30",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-030",
                            "eval": "data.rule.sql_logical_server_alert",
                            "message": "data.rule.sql_logical_server_alert_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_030.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Security Alert is enabled on Azure SQL Logical Server",
                    "description": "Advanced data security should be enabled on your SQL servers."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_31",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-031",
                            "eval": "data.rule.sql_server_alert",
                            "message": "data.rule.sql_server_alert_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_031.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_402"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Security Alert is enabled on Azure SQL Server",
                    "description": "Advanced data security should be enabled on your SQL servers."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_32",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-032",
                            "eval": "data.rule.sql_managed_instance_alert",
                            "message": "data.rule.sql_managed_instance_alert_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_032.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_403"
                    ],
                    "severity": "Medium",
                    "title": "Advanced data security should be enabled on your SQL managed instance.",
                    "description": "Advanced data security should be enabled on your SQL managed instance."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_33",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-033",
                            "eval": "data.rule.sql_logical_server_email_account",
                            "message": "data.rule.sql_logical_server_email_account_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_033.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure that VA setting 'Also send email notifications to admins and subscription owners' is set for a SQL server",
                    "description": "VA scan reports and alerts will be sent to admins and subscription owners by enabling the setting 'Also send email notifications to admins and subscription owners'. This may help in reducing the time required for identifying risks and taking corrective measures."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_34",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-034",
                            "eval": "data.rule.sql_server_email_account",
                            "message": "data.rule.sql_server_email_account_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_034.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_402"
                    ],
                    "severity": "High",
                    "title": "Ensure that VA setting 'Also send email notifications to admins and subscription owners' is set for a SQL server",
                    "description": "VA scan reports and alerts will be sent to admins and subscription owners by enabling the setting 'Also send email notifications to admins and subscription owners'. This may help in reducing the time required for identifying risks and taking corrective measures."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_35",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-035",
                            "eval": "data.rule.sql_logical_server_email_addressess",
                            "message": "data.rule.sql_logical_server_email_addressess_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_035.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Azure SQL Security Alert Policy should be configured to send alerts to the account administrators and configured email addresses",
                    "description": "Provide the email address where alerts will be sent when anomalous activities are detected on SQL servers."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_36",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-036",
                            "eval": "data.rule.sql_server_email_addressess",
                            "message": "data.rule.sql_server_email_addressess_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_036.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_402"
                    ],
                    "severity": "High",
                    "title": "Azure SQL Security Alert Policy should be configured to send alerts to the account administrators and configured email addresses",
                    "description": "Provide the email address where alerts will be sent when anomalous activities are detected on SQL servers."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_37",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-037",
                            "eval": "data.rule.sql_logical_server_retention_days",
                            "message": "data.rule.sql_logical_server_retention_days_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_037.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure SQL Server Threat Detection is Enabled and Retention Logs are greater than 90 days",
                    "description": "Azure SQL Database Threat Detection is a security intelligence feature built into the Azure SQL Database service. Working around the clock to learn, profile and detect anomalous database activities, Azure SQL Database Threat Detection identifies potential threats to the database. Security officers or other designated administrators can get an immediate notification about suspicious database activities as they occur. Each notification provides details of the suspicious activity and recommends how to further investigate and mitigate the threat."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_38",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-038",
                            "eval": "data.rule.sql_server_retention_days",
                            "message": "data.rule.sql_server_retention_days_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_038.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_402"
                    ],
                    "severity": "High",
                    "title": "Ensure SQL Server Threat Detection is Enabled and Retention Logs are greater than 90 days",
                    "description": "Azure SQL Database Threat Detection is a security intelligence feature built into the Azure SQL Database service. Working around the clock to learn, profile and detect anomalous database activities, Azure SQL Database Threat Detection identifies potential threats to the database. Security officers or other designated administrators can get an immediate notification about suspicious database activities as they occur. Each notification provides details of the suspicious activity and recommends how to further investigate and mitigate the threat."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_39",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-039",
                            "eval": "data.rule.sql_logical_server_disabled_alerts",
                            "message": "data.rule.sql_logical_server_disabled_alerts_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_039.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Azure SQL Server threat detection alerts should be enabled for all threat types",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification._x005F<br>_x005F<br>This policy identifies Azure SQL servers that have disabled the detection of one or more threat types. To protect your SQL Servers, as a best practice, enable ADS detection for all types of threats."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_40",
                    "type": "rego",
                    "rule": "file(sql_alert_policy.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-040",
                            "eval": "data.rule.sql_server_disabled_alerts",
                            "message": "data.rule.sql_server_disabled_alerts_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_040.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_402"
                    ],
                    "severity": "High",
                    "title": "Azure SQL Server threat detection alerts should be enabled for all threat types",
                    "description": "Advanced data security (ADS) provides a set of advanced SQL security capabilities, including vulnerability assessment, threat detection, and data discovery and classification._x005F<br>_x005F<br>This policy identifies Azure SQL servers that have disabled the detection of one or more threat types. To protect your SQL Servers, as a best practice, enable ADS detection for all types of threats."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_41",
                    "type": "rego",
                    "rule": "file(sql_managedinstance.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-041",
                            "eval": "data.rule.sql_mi_public_endpoint_disabled",
                            "message": "data.rule.sql_mi_public_endpoint_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_041.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_401"
                    ],
                    "severity": "Medium",
                    "title": "SQL Managed Instance should have public endpoint access disabled",
                    "description": "Always use Private Endpoint for Azure SQL Database and SQL Managed Instance"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_42",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-042",
                            "eval": "data.rule.sql_server_log_audit",
                            "message": "data.rule.sql_server_log_audit_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_042.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_404"
                    ],
                    "severity": "High",
                    "title": "Ensure that SQL Server Auditing is Enabled",
                    "description": "Ensure that SQL Server Auditing is enabled in order to keep track of Audit events."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_43",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-043",
                            "eval": "data.rule.sql_logical_server_log_audit",
                            "message": "data.rule.sql_logical_server_log_audit_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_043.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure that SQL Server Auditing is Enabled",
                    "description": "Ensure that SQL Server Auditing is enabled in order to keep track of Audit events."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_44",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-044",
                            "eval": "data.rule.sql_server_audit_log_retention",
                            "message": "data.rule.sql_server_audit_log_retention_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_044.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_404"
                    ],
                    "severity": "High",
                    "title": "Azure SQL server audit log retention should be greater than 90 days",
                    "description": "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access. We recommend you configure SQL server audit retention to be greater than 90 days."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_45",
                    "type": "rego",
                    "rule": "file(sql_servers_auditing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-045",
                            "eval": "data.rule.sql_logial_server_audit_log_retention",
                            "message": "data.rule.sql_logial_server_audit_log_retention_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_045.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Azure SQL server audit log retention should be greater than 90 days",
                    "description": "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access. We recommend you configure SQL server audit retention to be greater than 90 days."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_46",
                    "type": "rego",
                    "rule": "file(sql_servers_encryption.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-046",
                            "eval": "data.rule.serverKeyType",
                            "message": "data.rule.serverKeyType_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_046.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_407"
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL server's TDE protector is encrypted with Customer-managed key",
                    "description": "Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure’s cloud-based external key management system is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_47",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-047",
                            "eval": "data.rule.sql_public_access_disabled",
                            "message": "data.rule.sql_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_047.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure SQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for Azure SQL Database and SQL Managed Instance"
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_48",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-048",
                            "eval": "data.rule.sql_server_login",
                            "message": "data.rule.sql_server_login_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_048.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL Server administrator login does not contains 'Admin/Administrator' as name",
                    "description": "You must designate a Server admin login when you create an Azure SQL server. SQL server creates this account as a login in the master database. Only one such account can exist. This account connects using SQL Server authentication (username and password). It is recommended to avoid using names like 'admin' or 'administrator', which are targeted in brute force dictionary attacks."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_49",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-049",
                            "eval": "data.rule.sql_logical_server_login",
                            "message": "data.rule.sql_logical_server_login_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_049.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_405"
                    ],
                    "severity": "Medium",
                    "title": "Ensure SQL Server administrator login does not contains 'Admin/Administrator' as name",
                    "description": "You must designate a Server admin login when you create an Azure SQL server. SQL server creates this account as a login in the master database. Only one such account can exist. This account connects using SQL Server authentication (username and password). It is recommended to avoid using names like 'admin' or 'administrator', which are targeted in brute force dictionary attacks."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_50",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-050",
                            "eval": "data.rule.fail_over_groups",
                            "message": "data.rule.fail_over_groups_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_050.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Azure SQL Server data replication with Fail Over groups",
                    "description": "SQL Server data should be replicated to avoid loss of unreplicated data."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_51",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-051",
                            "eval": "data.rule.sql_server_administrators",
                            "message": "data.rule.sql_server_administrators_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_051.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure that Azure Active Directory Admin is configured for SQL Server",
                    "description": "Use Azure Active Directory Authentication for authentication with SQL Databases. Azure Active Directory authentication is a mechanism of connecting Microsoft Azure SQL Databases and SQL Data Warehouses using identities in an Azure Active Directory (Azure AD). With Azure AD authentication, you can centrally manage the identities of database users and other Microsoft services in one central location."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_69",
                    "type": "rego",
                    "rule": "file(sql_servers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-069",
                            "eval": "data.rule.sql_server_latest_tls_configured",
                            "message": "data.rule.sql_server_latest_tls_configured_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_069.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_400"
                    ],
                    "severity": "High",
                    "title": "Ensure Azure SQL Server has latest version of tls configured",
                    "description": "This policy will identify the Azure SQL Server which dont have latest version of tls configured and give alert"
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_1",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-001",
                            "eval": "data.rule.aks_cni_net",
                            "message": "data.rule.aks_cni_net_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure CNI networking should be enabled in Azure AKS cluster",
                    "description": "Azure CNI provides the following features over kubenet networking:<br><br>- Every pod in the cluster is assigned an IP address in the virtual network. The pods can directly communicate with other pods in the cluster, and other nodes in the virtual network.<br>- Pods in a subnet that have service endpoints enabled can securely connect to Azure services, such as Azure Storage and SQL DB.<br>- You can create user-defined routes (UDR) to route traffic from pods to a Network Virtual Appliance.<br>- Support for Network Policies securing communication between pods.<br><br>This policy checks your AKS cluster for the Azure CNI network plugin and generates an alert if not found."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_2",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-002",
                            "eval": "data.rule.aks_http_routing",
                            "message": "data.rule.aks_http_routing_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Azure AKS cluster HTTP application routing should be disabled",
                    "description": "The HTTP application routing add-on is designed to let you quickly create an ingress controller and access your applications. This add-on is not currently designed for use in a production environment and is not recommended for production use. For production-ready ingress deployments that include multiple replicas and TLS support, see Create an HTTPS ingress controller."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_3",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-003",
                            "eval": "data.rule.aks_monitoring",
                            "message": "data.rule.aks_monitoring_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Azure AKS cluster monitoring not enabled",
                    "description": "Azure Monitor for containers gives you performance visibility by collecting memory and processor metrics from controllers, nodes, and containers that are available in Kubernetes through the Metrics API. Container logs are also collected. After you enable monitoring from Kubernetes clusters, metrics and logs are automatically collected for you through a containerized version of the Log Analytics agent for Linux. Metrics are written to the metrics store and log data is written to the logs store associated with your Log Analytics workspace."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_4",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-004",
                            "eval": "data.rule.aks_nodes",
                            "message": "data.rule.aks_nodes_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Azure AKS cluster pool profile count should contain 3 nodes or more",
                    "description": "Ensure your AKS cluster pool profile count contains 3 or more nodes. This is recommended for a more resilient cluster. (Clusters smaller than 3 may experience downtime during upgrades.)<br><br>This policy checks the size of your cluster pool profiles and alerts if there are fewer than 3 nodes."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_5",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-005",
                            "eval": "data.rule.aks_rbac",
                            "message": "data.rule.aks_rbac_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "High",
                    "title": "Azure AKS enable role-based access control (RBAC) should be enforced",
                    "description": "To provide granular filtering of the actions that users can perform, Kubernetes uses role-based access controls (RBAC). This control mechanism lets you assign users, or groups of users, permission to do things like create or modify resources, or view logs from running application workloads. These permissions can be scoped to a single namespace, or granted across the entire AKS cluster._x005F<br>_x005F<br>This policy checks your AKS cluster RBAC setting and alerts if disabled."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_6",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-006",
                            "eval": "data.rule.aks_aad_azure_rbac",
                            "message": "data.rule.aks_aad_azure_rbac_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Managed Azure AD RBAC for AKS cluster should be enabled",
                    "description": "Azure Kubernetes Service (AKS) can be configured to use Azure Active Directory (AD) for user authentication. In this configuration, you sign in to an AKS cluster using an Azure AD authentication token. You can also configure Kubernetes role-based access control (Kubernetes RBAC) to limit access to cluster resources based a user's identity or group membership. Visit https://docs.microsoft.com/en-us/azure/aks/azure-ad-rbac for details."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_7",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-007",
                            "eval": "data.rule.aks_authorized_Ip",
                            "message": "data.rule.aks_authorized_Ip_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Ensure AKS API server defines authorized IP ranges",
                    "description": "The AKS API server receives requests to perform actions in the cluster , for example, to create resources, and scale the number of nodes. The API server provides a secure way to manage a cluster."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_8",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-008",
                            "eval": "data.rule.network_policy",
                            "message": "data.rule.network_policy_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Low",
                    "title": "Ensure AKS cluster network policies are enforced",
                    "description": "Network policy options in AKS include two ways to implement a network policy. You can choose between Azure Network Policies or Calico Network Policies. In both cases, the underlying controlling layer is based on Linux IPTables to enforce the specified policies. Policies are translated into sets of allowed and disallowed IP pairs. These pairs are then programmed as IPTable rules."
                },
                {
                    "masterTestId": "AZURE_TEST_AKS_9",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AKS-009",
                            "eval": "data.rule.aks_kub_dashboard_disabled",
                            "message": "data.rule.aks_kub_dashboard_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AKS_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_219"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Kubernetes Dashboard is disabled",
                    "description": "Disable the Kubernetes dashboard on Azure Kubernetes Service"
                },
                {
                    "masterTestId": "AZURE_TEST_AGW_1",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AGW-001",
                            "eval": "data.rule.gw_tls",
                            "message": "data.rule.gw_tls_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AGW_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Azure Application Gateway should not allow TLSv1.1 or lower",
                    "description": "Transport Layer Security (TLS), previously known as Secure Sockets Layer (SSL), is the standard security technology for establishing an encrypted link between a web server and a browser. This link ensures that all data passed between the web server and browsers remain private and encrypted. Application gateway supports both TLS termination at the gateway as well as end to end TLS encryption. The minimum allowed TLS version should be 1.2"
                },
                {
                    "masterTestId": "AZURE_TEST_AGW_2",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AGW-002",
                            "eval": "data.rule.gw_waf",
                            "message": "data.rule.gw_waf_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AGW_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Azure Application Gateway should have the Web application firewall (WAF) enabled",
                    "description": "Azure Web Application Firewall (WAF) on Azure Application Gateway provides centralized protection of your web applications from common exploits and vulnerabilities. Web applications are increasingly targeted by malicious attacks that exploit commonly known vulnerabilities. SQL injection and cross-site scripting are among the most common attacks."
                },
                {
                    "masterTestId": "AZURE_TEST_AGW_3",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AGW-003",
                            "eval": "data.rule.protocol",
                            "message": "data.rule.protocol_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AGW_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway is using Https protocol",
                    "description": "Application Gateway allows to set network protocols Http and Https. It is highly recommended to use Https protocol for secure connections."
                },
                {
                    "masterTestId": "AZURE_TEST_AGW_4",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AGW-004",
                            "eval": "data.rule.frontendPublicIPConfigurationsDisabled",
                            "message": "data.rule.frontendPublicIPConfigurationsDisabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AGW_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway frontendIPConfigurations does not have public ip configured",
                    "description": "Application Gateway allows to set public or private ip in frontendIPConfigurations. It is highly recommended to only configure private ip in frontendIPConfigurations."
                },
                {
                    "masterTestId": "AZURE_TEST_AGW_5",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AGW-005",
                            "eval": "data.rule.backend_https_protocol_enabled",
                            "message": "data.rule.backend_https_protocol_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AGW_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway Backend is using Https protocol",
                    "description": "Application Gateway allows to set backend network protocols Http and Https. It is highly recommended to use Https protocol for secure connections."
                },
                {
                    "masterTestId": "AZURE_TEST_AGW_6",
                    "type": "rego",
                    "rule": "file(aks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AGW-006",
                            "eval": "data.rule.secret_certificate_is_in_keyvalut",
                            "message": "data.rule.secret_certificate_is_in_keyvalut_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AGW_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_221"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Application Gateway secret certificates stores in keyvault",
                    "description": "This policy will identify application gateways which dont have ssl certificates stored in keyvalut and alert"
                },
                {
                    "masterTestId": "AZURE_TEST_ARC_1",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ARC-001",
                            "eval": "data.rule.enableSslPort",
                            "message": "data.rule.enableSslPort_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ARC_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "GDPR",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420"
                    ],
                    "severity": "High",
                    "title": "Ensure that the Redis Cache accepts only SSL connections",
                    "description": "It is recommended that Redis Cache should allow only SSL connections. Note: some Redis tools (like redis-cli) do not support SSL. When using such tools plain connection ports should be enabled."
                },
                {
                    "masterTestId": "AZURE_TEST_ARC_2",
                    "type": "rego",
                    "rule": "file(Redis.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ARC-002",
                            "eval": "data.rule.serverRole",
                            "message": "data.rule.serverRole_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ARC_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "PCI-DSS",
                                "ISO 27001",
                                "NIST CSF",
                                "HIPAA",
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_420",
                        "AZRSNP_421"
                    ],
                    "severity": "Medium",
                    "title": "Redis cache should have a backup",
                    "description": "Replicate Redis Cache server data to another Redis Cache server using geo replication. This feature is only available for Premium tier Redis Cache. From performance point of view, Microsoft recommends that both Redis Caches (Primary and the linked secondary) reside in the same region."
                },
                {
                    "masterTestId": "AZURE_TEST_VM_1",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-VM-001",
                            "eval": "data.rule.vm_aset",
                            "message": "data.rule.vm_aset_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_VM_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine should be assigned to an availability set",
                    "description": "To provide application redundancy during planned or unplanned maintenance events, you can group two or more virtual machines (VMs) in an availability set. An availability set ensures that the VMs are distributed across multiple isolated hardware nodes in a cluster so that only a subset of your VMs are impacted should a hardware or software failure occur on Azure.<br><br>This policy identifies Azure VMs that are not deployed in an availability set. As a high availability (HA) best practice, deploy your VMs in an availability set."
                },
                {
                    "masterTestId": "AZURE_TEST_VM_2",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-VM-002",
                            "eval": "data.rule.linux_configuration",
                            "message": "data.rule.linux_configuration_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_VM_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ],
                    "severity": "High",
                    "title": "Ensure Azure instance authenticates using SSH keys",
                    "description": "SSH is an encrypted connection protocol that allows secure sign-ins over unsecured connections. SSH is the default connection protocol for Linux VMs hosted in Azure. Using secure shell (SSH) key pair, it is possible to spin up a Linux virtual machine on Azure that defaults to using SSH keys for authentication, eliminating the need for passwords to sign in. We recommend connecting to a VM using SSH keys. Using basic authentication with SSH connections leaves VMs vulnerable to brute-force attacks or guessing of passwords."
                },
                {
                    "masterTestId": "AZURE_TEST_VM_3",
                    "type": "rego",
                    "rule": "file(vm.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-VM-003",
                            "eval": "data.rule.vm_protection",
                            "message": "data.rule.vm_protection_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_VM_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_273"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Machine should have endpoint protection installed",
                    "description": "This policy identifies Azure Virtual Machines (VMs) that do not have endpoint protection installed. Installing endpoint protection systems (like Antimalware for Azure) provides for real-time protection capability that helps identify and remove viruses, spyware, and other malicious software. As a best practice, install endpoint protection on all VMs and computers to help identify and remove viruses, spyware, and other malicious software."
                },
                {
                    "masterTestId": "AZURE_TEST_DSK_1",
                    "type": "rego",
                    "rule": "file(disks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-DSK-001",
                            "eval": "data.rule.disk_encrypt",
                            "message": "data.rule.disk_encrypt_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_DSK_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Compute"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_277"
                    ],
                    "severity": "High",
                    "title": "Azure disk should have Azure Disk Encryption (ADE) enabled",
                    "description": "To meet your organizational security or compliance requirement, Azure provides disk encryption at rest using Azure Storage Service Encryption (SSE) and Azure Disk Encryption (ADE). Starting February 2017, SSE is enabled by default for all managed disks. ADE is integrated with Azure Key Vault to help you control, manage, and audit the disk encryption keys and secrets.<br><br>This policy detects Virtual Machine (VM) OS disks that are not encrypted at rest using ADE. As a best practice, enable ADE for provide volume encryption for the OS disk. For more information, see https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview."
                },
                {
                    "masterTestId": "AZURE_TEST_VNET_4",
                    "type": "rego",
                    "rule": "file(vnetpeerings.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NET-004",
                            "eval": "data.rule.vnet_peer",
                            "message": "data.rule.vnet_peer_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NET_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_430"
                    ],
                    "severity": "Medium",
                    "title": "Azure virtual network peering state should be connected",
                    "description": "Virtual network peering enables you to connect two Azure virtual networks so that the resources in these networks are directly connected.<br><br>This policy identifies Azure virtual network peers that are disconnected. Typically, the disconnection happens when a peering configuration is deleted on one virtual network, and the other virtual network reports the peering status as disconnected."
                },
                {
                    "masterTestId": "AZURE_TEST_VNET_5",
                    "type": "rego",
                    "rule": "file(vnetsubnets.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NET-005",
                            "eval": "data.rule.vnet_subnet_nsg",
                            "message": "data.rule.vnet_subnet_nsg_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NET-005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_275"
                    ],
                    "severity": "Medium",
                    "title": "Azure Virtual Network subnet should be configured with Network Security Group",
                    "description": "This policy identifies Azure Virtual Network (VNet) subnet which dont have any association with Network Security Group (NSG). While binding an NSG to a network interface of a Virtual Machine (VM) enables fine-grained control to the VM, associating a NSG to a subnet enables better control over network traffic to all resources within a subnet. As a best practice, associate an NSG with a subnet so that you can protect your VMs on a subnet-level._x005F<br>_x005F<br>For more information, see https://blogs.msdn.microsoft.com/igorpag/2016/05/14/azure-network-security-groups-nsg-best-practices-and-lessons-learned/"
                },
                {
                    "masterTestId": "AZURE_TEST_VNET_6",
                    "type": "rego",
                    "rule": "file(vpngateways.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NET-006",
                            "eval": "data.rule.vpn_encrypt",
                            "message": "data.rule.vpn_encrypt_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NET_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_307"
                    ],
                    "severity": "Medium",
                    "title": "Ensure VPN gateways is configured with cryptographic algorithm",
                    "description": "Azure VPN gateways to use a custom IPsec/IKE policy with specific cryptographic algorithms and key strengths, rather than the Azure default policy sets. IPsec and IKE protocol standard supports a wide range of cryptographic algorithms in various combinations. If customers do not request a specific combination of cryptographic algorithms and parameters, Azure VPN gateways use a set of default proposals. Typically due to compliance or security requirements, you can now configure your Azure VPN gateways to use a custom IPsec/IKE policy with specific cryptographic algorithms and key strengths, rather than the Azure default policy sets. It is thus recommended to use custom policy sets and choose strong cryptography."
                },
                {
                    "masterTestId": "AZURE_TEST_NTW_1",
                    "type": "rego",
                    "rule": "file(networkwatchersflowlogs.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NTW-001",
                            "eval": "data.rule.netwatchFlowlogs",
                            "message": "data.rule.netwatchFlowlogs_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NTW_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_431"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) flow logs should be enabled",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs are disabled. To perform this check, enable this action on the Azure Service Principal: 'Microsoft.Network/networkWatchers/queryFlowLogStatus/action'.<br><br>NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:<br>- Outbound and inbound flows on a per-rule basis.<br>- Network interface to which the flow applies.<br>- 5-tuple information about the flow (source/destination IP, source/destination port, protocol).<br>- Whether the traffic was allowed or denied.<br><br>As a best practice, enable NSG flow logs to improve network visibility."
                },
                {
                    "masterTestId": "AZURE_TEST_NTW_2",
                    "type": "rego",
                    "rule": "file(networkwatchersflowlogs.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NTW-002",
                            "eval": "data.rule.netwatch_logs",
                            "message": "data.rule.netwatch_logs_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NTW_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_431"
                    ],
                    "severity": "Medium",
                    "title": "Azure Network Watcher Network Security Group (NSG) traffic analytics should be enabled",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs are disabled. To perform this check, enable this action on the Azure Service Principal: 'Microsoft.Network/networkWatchers/queryFlowLogStatus/action'.<br><br>NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:<br>- Outbound and inbound flows on a per-rule basis.<br>- Network interface to which the flow applies.<br>- 5-tuple information about the flow (source/destination IP, source/destination port, protocol).<br>- Whether the traffic was allowed or denied.<br><br>As a best practice, enable NSG flow logs to improve network visibility."
                },
                {
                    "masterTestId": "AZURE_TEST_NTW_3",
                    "type": "rego",
                    "rule": "file(networkwatchersflowlogs.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NTW-003",
                            "eval": "data.rule.netwatch_log_retention",
                            "message": "data.rule.netwatch_log_retention_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NTW_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_431"
                    ],
                    "severity": "High",
                    "title": "Azure Network Watcher Network Security Group (NSG) flow logs retention should be greater than 90 days",
                    "description": "This policy identifies Azure Network Security Groups (NSG) for which flow logs retention period is 90 days or less. To perform this check, enable this action on the Azure Service Principal: 'Microsoft.Network/networkWatchers/queryFlowLogStatus/action'.<br><br>NSG flow logs, a feature of the Network Watcher app, enable you to view information about ingress and egress IP traffic through an NSG. The flow logs include information such as:<br>- Outbound and inbound flows on a per-rule basis.<br>- Network interface to which the flow applies.<br>- 5-tuple information about the flow (source/destination IP, source/destination port, protocol).<br>- Whether the traffic was allowed or denied.<br><br>As a best practice, enable NSG flow logs and set the log retention period to at least 90 days."
                },
                {
                    "masterTestId": "AZURE_TEST_DBK_1",
                    "type": "rego",
                    "rule": "file(databricks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-DBK-001",
                            "eval": "data.rule.databrics_workspace_has_public_ip_disabled",
                            "message": "data.rule.databrics_workspace_has_public_ip_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_DBK_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Analytics"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_440"
                    ],
                    "severity": "High",
                    "title": "Azure Databricks shoud not use public IP address",
                    "description": "Azure Databricks is a data analytics platform optimized for the Microsoft Azure cloud services platform. This policy will identify Databricks which does not have public ip disabled and warn."
                },
                {
                    "masterTestId": "AZURE_TEST_DBK_2",
                    "type": "rego",
                    "rule": "file(databricks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-DBK-002",
                            "eval": "data.rule.databrics_workspace_has_vnet_integration",
                            "message": "data.rule.databrics_workspace_has_vnet_integration_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_DBK_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Analytics"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_440",
                        "AZRSNP_284"
                    ],
                    "severity": "Medium",
                    "title": "Azure Databricks should have vnet integration",
                    "description": "Azure Databricks is a data analytics platform optimized for the Microsoft Azure cloud services platform. This policy will identify Databricks which does not have vnet integration and warn."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_28",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-028",
                            "eval": "data.rule.geoRedundantBackup",
                            "message": "data.rule.geoRedundantBackup_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_028.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "Medium",
                    "title": "Ensure Geo-redundant backup is enabled on PostgreSQL database server.",
                    "description": "Azure Database for PostgreSQL provides the flexibility to choose between locally redundant or geo-redundant backup storage in the General Purpose and Memory Optimized tiers. When the backups are stored in geo-redundant backup storage, they are not only stored within the region in which your server is hosted, but are also replicated to a paired data center. This provides better protection and ability to restore your server in a different region in the event of a disaster. The Basic tier only offers locally redundant backup storage."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_29",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-029",
                            "eval": "data.rule.sslEnforcement",
                            "message": "data.rule.sslEnforcement_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_029.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "High",
                    "title": "Ensure ssl enforcement is enabled on PostgreSQL Database Server.",
                    "description": "Enable SSL connection on PostgreSQL Servers. Rationale: SSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application."
                },
                {
                    "masterTestId": "AZURE_TEST_SQL_66",
                    "type": "rego",
                    "rule": "file(postgreSQL.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-SQL-066",
                            "eval": "data.rule.postgresql_public_access_disabled",
                            "message": "data.rule.postgresql_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_SQL_066.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Databases"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_412"
                    ],
                    "severity": "High",
                    "title": "Ensure PostgreSQL servers don't have public network access enabled",
                    "description": "Always use Private Endpoint for PostgreSQL Server"
                },
                {
                    "masterTestId": "AZURE_TEST_ACR_001",
                    "type": "rego",
                    "rule": "file(registrieswebhooks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ACR-001",
                            "eval": "data.rule.acr_webhooks",
                            "message": "data.rule.acr_webhooks_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ACR_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_214"
                    ],
                    "severity": "Medium",
                    "title": "Azure ACR should have HTTPS protocol enabled for webhook",
                    "description": "Ensure you send container registry webhooks only to a HTTPS endpoint. This policy checks your container registry webhooks and alerts if it finds a URI with HTTP."
                },
                {
                    "masterTestId": "AZURE_TEST_ACR_2",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ACR-002",
                            "eval": "data.rule.adminUserDisabled",
                            "message": "data.rule.adminUserDisabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ACR_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "Best Practices"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "Medium",
                    "title": "Ensure that admin user is disabled for Container Registry",
                    "description": "The value that indicates whether the admin user is enabled. Each container registry includes an admin user account, which is disabled by default. You can enable the admin user and manage its credentials in the Azure portal, or by using the Azure CLI or other Azure tools. All users authenticating with the admin account appear as a single user with push and pull access to the registry. Changing or disabling this account disables registry access for all users who use its credentials."
                },
                {
                    "masterTestId": "AZURE_TEST_ACR_3",
                    "type": "rego",
                    "rule": "file(registry.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ACR-003",
                            "eval": "data.rule.acr_classic",
                            "message": "data.rule.acr_classic_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ACR_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Containers"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "severity": "High",
                    "title": "Azure Container Registry should not use the deprecated classic registry",
                    "description": "This policy identifies an Azure Container Registry (ACR) that is using the classic SKU. The initial release of the Azure Container Registry (ACR) service that was offered as a classic SKU is being deprecated and will be unavailable after April 2019. As a best practice, upgrade your existing classic registry to a managed registry.<br><br>For more information, visit https://docs.microsoft.com/en-us/azure/container-registry/container-registry-upgrade"
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_1",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-001",
                            "eval": "data.rule.nsg_in_tcp_all_src",
                            "message": "data.rule.nsg_in_tcp_all_src_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all TCP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open TCP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_2",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-002",
                            "eval": "data.rule.nsg_in_udp_all_src",
                            "message": "data.rule.nsg_in_udp_all_src_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all UDP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open UDP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_3",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-003",
                            "eval": "data.rule.nsg_in_tcp_all",
                            "message": "data.rule.nsg_in_tcp_all_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all traffic from Internet on TCP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on TCP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_4",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-004",
                            "eval": "data.rule.nsg_in_udp_all",
                            "message": "data.rule.nsg_in_udp_all_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_004.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all traffic from Internet on UDP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on UDP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_5",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-005",
                            "eval": "data.rule.nsg_in_all",
                            "message": "data.rule.nsg_in_all_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to all traffic from Internet on any protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on any protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_6",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-006",
                            "eval": "data.rule.nsg_in_all_src",
                            "message": "data.rule.nsg_in_all_src_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_006.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) shouldn't have Inbound rule overly permissive to allow all traffic from any source on any protocol",
                    "description": "This policy identifies NSGs which allows incoming traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources on authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_7",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-007",
                            "eval": "data.rule.nsg_in_all_dst",
                            "message": "data.rule.nsg_in_all_dst_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_007.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) having Inbound rule overly permissive to allow all traffic from any source to any destination",
                    "description": "This policy identifies NSGs which allows incoming traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources on authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_8",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-008",
                            "eval": "data.rule.nsg_allow_icmp",
                            "message": "data.rule.nsg_allow_icmp_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group shouldn't allows ICMP (Ping)",
                    "description": "ICMP is used by devices to communicate error messages and status. While ICMP is useful for  diagnostics and troubleshooting, it can also be used to exploit or disrupt systems.<br><br>This policy detects any NSG rule that allows ICMP (Ping) traffic from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict ICMP (Ping) solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_9",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-009",
                            "eval": "data.rule.inbound_port_21",
                            "message": "data.rule.inbound_port_21_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group shouldn't allow FTP (TCP Port 21)",
                    "description": "This policy detects any NSG rule that allows FTP traffic on TCP port 21 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict FTP solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_10",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-010",
                            "eval": "data.rule.inbound_insecure_port",
                            "message": "data.rule.inbound_insecure_port_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "GDPR",
                                "HIPAA",
                                "NIST CSF",
                                "PCI-DSS",
                                "SOC 2"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Internet connectivity via tcp over insecure port should be prevented",
                    "description": "Identify network traffic coming from internet which is plain text FTP, Telnet or HTTP from Internet."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_11",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-011",
                            "eval": "data.rule.inbound_port_11211",
                            "message": "data.rule.inbound_port_11211_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Memcached DDoS attack attempt should be prevented",
                    "description": "Memcached is a general-purpose distributed memory caching system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source (such as a database or API) must be read. It is reported that Memcache versions 1.5.5 and below are vulnerable to DDoS amplification attack. This policy aims at finding such attacks and generate alerts."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_12",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-012",
                            "eval": "data.rule.inbound_port_6379",
                            "message": "data.rule.inbound_port_6379_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "RedisWannaMine vulnerable instances with active network traffic should be locked down",
                    "description": "RedisWannaMine is cryptojacking attack which aims at both database servers and application servers via remote code execution, exploiting an Apache Struts vulnerability. To inject cryptocurrency mining malware, RedWannaMine uses a transmission control protocol (TCP) scanner to check open port 445 of SMB and scans vulnerable Redis server database over port 6379(tcp), so that it can use EternalBlue to spread further."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_13",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-013",
                            "eval": "data.rule.inbound_port_dbs",
                            "message": "data.rule.inbound_port_dbs_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Publicly should not expose DB Ports",
                    "description": "DB Servers contain sensitive data and should not be exposed to any direct traffic from internet. This policy checks for the network traffic from internet hitting the DB Servers on their default ports. The DB servers monitored on the default ports are : Microsoft SQL Server (1433), Oracle (1521), MySQL (3306), Sybase (5000), Postgresql (5432), CouchDB (5984), Redis (6379, 6380), RethinkDB (8080,28015, 29015), CassandraDB (9042), Memcached (11211), MongoDB (27017), DB2 (50000)."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_14",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-014",
                            "eval": "data.rule.inbound_port_22",
                            "message": "data.rule.inbound_port_22_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_014.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) should not allow SSH traffic from internet on port 22",
                    "description": "Blocking SSH port 22 will protect users from attacks like Account compromise."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_15",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-015",
                            "eval": "data.rule.inbound_port_3389",
                            "message": "data.rule.inbound_port_3389_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_015.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) should not allow traffic from internet on port 3389",
                    "description": "Blocking RDP port 3389 will protect users from attacks like account compromise, Denial of service and ransomware."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_16",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-016",
                            "eval": "data.rule.inbound_port_445",
                            "message": "data.rule.inbound_port_445_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_016.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow Windows SMB (TCP Port 445)",
                    "description": "This policy detects any NSG rule that allows Windows SMB traffic on TCP port 445 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict Windows SMB solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_18",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-018",
                            "eval": "data.rule.inbound_port_53",
                            "message": "data.rule.inbound_port_53_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_018.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow DNS (UDP Port 53)",
                    "description": "This policy detects any NSG rule that allows DNS traffic on UDP port 53 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict DNS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_19",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-019",
                            "eval": "data.rule.inbound_port_20",
                            "message": "data.rule.inbound_port_20_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_019.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow FTP-Data (TCP Port 20)",
                    "description": "This policy detects any NSG rule that allows FTP-Data traffic on TCP port 20 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict FTP-Data solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_20",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-020",
                            "eval": "data.rule.inbound_port_4333",
                            "message": "data.rule.inbound_port_4333_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_020.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow MS SQL (TCP Port 4333)",
                    "description": "This policy detects any NSG rule that allows MSQL traffic on TCP port 4333 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict MSQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_21",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-021",
                            "eval": "data.rule.inbound_port_3306",
                            "message": "data.rule.inbound_port_3306_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_021.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow MySQL (TCP Port 3306)",
                    "description": "This policy detects any NSG rule that allows MySQL traffic on TCP port 3306 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict MySQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_22",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-022",
                            "eval": "data.rule.inbound_port_netbios",
                            "message": "data.rule.inbound_port_netbios_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_022.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group allows NetBIOS (UDP Port 137 and 138)",
                    "description": "This policy detects any NSG rule that allows NetBIOS traffic on UDP port 137 and 138 from the internet. Review your list of NSG rules to ensure that your resources are not exposed._x005F<br>As a best practice, restrict NetBIOS solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_23",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-023",
                            "eval": "data.rule.inbound_port_5432",
                            "message": "data.rule.inbound_port_5432_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_023.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow PostgreSQL (TCP Port 5432)",
                    "description": "This policy detects any NSG rule that allows PostgreSQL traffic on TCP port 5432 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict PostgreSQL solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_24",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-024",
                            "eval": "data.rule.inbound_port_25",
                            "message": "data.rule.inbound_port_25_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_024.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow SMTP (TCP Port 25)",
                    "description": "This policy detects any NSG rule that allows SMTP traffic on TCP port 25 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict SMTP solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_25",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-025",
                            "eval": "data.rule.inbound_port_sqlserver",
                            "message": "data.rule.inbound_port_sqlserver_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_025.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group allows SQLServer (TCP Port 1433 and UDP Port 1434)",
                    "description": "This policy detects any NSG rule that allows SQLServer traffic on TCP Port 1433 and UDP Port 1434 from the internet. Review your list of NSG rules to ensure that your resources are not exposed._x005F<br>As a best practice, restrict SQLServer solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_26",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-026",
                            "eval": "data.rule.inbound_port_23",
                            "message": "data.rule.inbound_port_23_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_026.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow Telnet (TCP Port 23)",
                    "description": "Telnet provides a plaintext connection to manage devices using the command line, and is less secure than SSH.<br>This policy detects any NSG rule that allows Telnet traffic on TCP port 23 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict Telnet solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_27",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-027",
                            "eval": "data.rule.inbound_port_5500",
                            "message": "data.rule.inbound_port_5500_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_027.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow VNC Listener (TCP Port 5500)",
                    "description": "This policy detects any NSG rule that allows VNC Listener traffic on TCP port 5500 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict VNC Listener solely to known static IP addresses. Limit the access list to include known hosts, services,     or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_28",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-028",
                            "eval": "data.rule.inbound_port_5900",
                            "message": "data.rule.inbound_port_5900_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_028.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow VNC Server (TCP Port 5900)",
                    "description": "This policy detects any NSG rule that allows VNC Server traffic on TCP port 5900 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict VNC Server solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_29",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-029",
                            "eval": "data.rule.inbound_port_135",
                            "message": "data.rule.inbound_port_135_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_029.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group should not allow Windows RPC (TCP Port 135)",
                    "description": "This policy detects any NSG rule that allows Windows RPC traffic on TCP port 135 from the internet. Review your list of NSG rules to ensure that your resources are not exposed.<br>As a best practice, restrict Windows RPC solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_30",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-030",
                            "eval": "data.rule.nsg_out_all",
                            "message": "data.rule.nsg_out_all_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_030.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group with Outbound rule to should not allow all traffic to any source",
                    "description": "This policy identifies NSGs which allows outgoing traffic to any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic to known sources on authorized protocols and ports."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_31",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-031",
                            "eval": "data.rule.outbound_port_bitcoin",
                            "message": "data.rule.outbound_port_bitcoin_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_031.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Instance should not be allowed with ports known to mine Bitcoin",
                    "description": "Identifies traffic from internal workloads to internet IPs on ports 8332,8333 that are known to mine Bitcoins. Unless this traffic is part of authorized applications and processes, your instances may have been compromised."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_32",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-032",
                            "eval": "data.rule.outbound_port_ethereum",
                            "message": "data.rule.outbound_port_ethereum_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_032.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "HIPAA",
                                "NIST CSF"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "Medium",
                    "title": "Instance should not be allowed communicating with ports known to mine Ethereum",
                    "description": "Identifies traffic from internal workloads to internet IPs on ports 8545,30303 that are known to mine Ethereum. Unless this traffic is part of authorized applications and processes, your instances may have been compromised."
                },
                {
                    "masterTestId": "AZURE_TEST_NSG_17",
                    "type": "rego",
                    "rule": "file(nsg.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-NSG-017",
                            "eval": "data.rule.inbound_insecure_omi_port",
                            "message": "data.rule.inbound_insecure_omi_port_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_NSG_017.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Networking"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ],
                    "severity": "High",
                    "title": "Azure Network Security Group (NSG) should protect OMIGOD attack from internet",
                    "description": "Blocking OMI port 5985, 5986, 1270 will protect vnet/subnet/vms from OMIGOD attacks from internet."
                },
                {
                    "masterTestId": "AZURE_TEST_MNT_1",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-MNT-001",
                            "eval": "data.rule.alerts",
                            "message": "data.rule.alerts_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_MNT_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_299"
                    ],
                    "severity": "Low",
                    "title": "Activity log alerts settings should be enabled",
                    "description": "Activity log alerts are alerts that activate when a new activity log event occurs that matches the conditions specified in the alert. Based on the order and volume of the events recorded in Azure activity log, the alert rule will fire. Activity log alert rules are Azure resources, so they can be created by using an Azure Resource Manager template. "
                },
                {
                    "masterTestId": "AZURE_TEST_MNT_9",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-MNT-009",
                            "eval": "data.rule.log_profiles_retention_days",
                            "message": "data.rule.log_profiles_retention_days_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_MNT_009.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_299"
                    ],
                    "severity": "High",
                    "title": "activity log retention should be set to 365 days or greater",
                    "description": "Specifies the retention policy for the log. We recommend you set activity log retention for 365 days or greater. (A value of 0 will retain the events indefinitely.)"
                },
                {
                    "masterTestId": "AZURE_TEST_MNT_10",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-MNT-010",
                            "eval": "data.rule.log_profiles_retention_enabled",
                            "message": "data.rule.log_profiles_retention_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_MNT_010.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_299"
                    ],
                    "severity": "High",
                    "title": "Activity log profile retention should be enabled",
                    "description": "This policy identifies Microsoft.Insights/logprofiles which dont have log retention enabled. Activity Logs can be used to check for anomalies and gives insight into suspected breaches or misuse of information and access."
                },
                {
                    "masterTestId": "AZURE_TEST_MNT_11",
                    "type": "rego",
                    "rule": "file(activitylogalerts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-MNT-011",
                            "eval": "data.rule.log_profile_category",
                            "message": "data.rule.log_profile_category_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_MNT_011.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Management and governance"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_299"
                    ],
                    "severity": "High",
                    "title": "log profile should be configured to capture all activities",
                    "description": "the categories of the logs. These categories are created as is convenient to the user. Some values are: 'Write', 'Delete', and/or 'Action.' We recommend you configure the log profile to export all activities from the control/management plane."
                },
                {
                    "masterTestId": "AZURE_TEST_STR_1",
                    "type": "rego",
                    "rule": "file(blobservices.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-STR-001",
                            "eval": "data.rule.storage_blob_soft_delete",
                            "message": "data.rule.storage_blob_soft_delete_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITTRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_223"
                    ],
                    "severity": "Medium",
                    "title": "Soft delete on blob service should be enabled",
                    "description": "The blob service properties for blob soft delete. It helps to restore removed blob within configured retention days"
                },
                {
                    "masterTestId": "AZURE_TEST_STR_2",
                    "type": "rego",
                    "rule": "file(blobservices.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-STR-002",
                            "eval": "data.rule.storage_blob_container_soft_delete",
                            "message": "data.rule.storage_blob_container_soft_delete_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITTRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_223"
                    ],
                    "severity": "Medium",
                    "title": "Soft delete on blob service container should be enabled",
                    "description": "The blob service properties for container soft delete. It helps to restore removed blob containers within configured retention days."
                },
                {
                    "masterTestId": "AZURE_TEST_AML_008",
                    "type": "rego",
                    "rule": "file(locks.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-AML-008",
                            "eval": "data.rule.rg_locks",
                            "message": "data.rule.rg_locks_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_AML_008.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_261"
                    ],
                    "severity": "Low",
                    "title": "Azure Deployment Scope Resource Group should have a remove protection resource lock configured",
                    "description": "Azure Resource Manager locks provide a way to lock down Azure resources from being deleted or modified. The lock level can be set to either 'CanNotDelete' or 'ReadOnly'. When you apply a lock at a parent scope, all resources within the scope inherit the same lock, and the most restrictive lock takes precedence.<br><br>This policy identifies Azure Resource Groups that do not have a lock set. As a best practice, place a lock on important resources to prevent accidental or malicious modification or deletion by unauthorized users."
                },
                {
                    "masterTestId": "AZURE_TEST_STR_12",
                    "type": "rego",
                    "rule": "file(storageblobcontainers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-STR-012",
                            "eval": "data.rule.storage_container_public_access_disabled",
                            "message": "data.rule.storage_container_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_012.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "HITRUST",
                                "NIST 800",
                                "NIST CSF",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_283"
                    ],
                    "severity": "High",
                    "title": "Azure storage blob container should not have public access enabled",
                    "description": "'Public access level' allows you to grant anonymous/public read access to a container and the blobs within Azure blob storage. By doing so, you can grant read-only access to these resources without sharing your account key, and without requiring a shared access signature._x005F<br>_x005F<br>This policy identifies blob containers within an Azure storage account that allow anonymous/public access ('CONTAINER' or 'BLOB'). As a best practice, do not allow anonymous/public access to blob containers unless you have a very good reason. Instead, you should consider using a shared access signature token for providing controlled and time-limited access to blob containers."
                },
                {
                    "masterTestId": "AZURE_TEST_STR_13",
                    "type": "rego",
                    "rule": "file(storageblobcontainers.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-STR-013",
                            "eval": "data.rule.storage__logical_container_public_access_disabled",
                            "message": "data.rule.storage__logical_container_public_access_disabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_STR_013.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [],
                            "service": [
                                "Storage"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ],
                    "severity": "High",
                    "title": "Azure storage blob container should not have public access enabled",
                    "description": "'Public access level' allows you to grant anonymous/public read access to a container and the blobs within Azure blob storage. By doing so, you can grant read-only access to these resources without sharing your account key, and without requiring a shared access signature._x005F<br>_x005F<br>This policy identifies blob containers within an Azure storage account that allow anonymous/public access ('CONTAINER' or 'BLOB'). As a best practice, do not allow anonymous/public access to blob containers unless you have a very good reason. Instead, you should consider using a shared access signature token for providing controlled and time-limited access to blob containers."
                },
                {
                    "masterTestId": "AZURE_TEST_ASC_1",
                    "type": "rego",
                    "rule": "file(pricing.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ASC-001",
                            "eval": "data.rule.pricing",
                            "message": "data.rule.pricing_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ASC_001.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "ISO 27001"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_300"
                    ],
                    "severity": "High",
                    "title": "Azure Security Center should have pricing tier configured to 'standard'",
                    "description": "Selecting the standard pricing tier will enable threat detection for networks and virtual systems by providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center."
                },
                {
                    "masterTestId": "AZURE_TEST_ASC_2",
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ASC-002",
                            "eval": "data.rule.securitycontacts",
                            "message": "data.rule.securitycontacts_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ASC_002.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Low",
                    "title": "Security Center shoud have security contact emails configured to get notifications",
                    "description": "Setting a valid email address in Security contact emails will enable Microsoft to contact you if the Microsoft Security Response Center (MSRC) discovers that your data has been accessed by an unlawful or unauthorized party. This will make sure that you are aware of any security issues and take prompt actions to mitigate the risks."
                },
                {
                    "masterTestId": "AZURE_TEST_ASC_3",
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ASC-003",
                            "eval": "data.rule.alert_notifications",
                            "message": "data.rule.alert_notifications_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ASC_003.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Medium",
                    "title": "Send email notification should be enabled",
                    "description": "Setting the security alert Send email notification for alerts to On ensures that emails are sent from Microsoft if their security team determines a potential security breach has taken place."
                },
                {
                    "masterTestId": "AZURE_TEST_ASC_5",
                    "type": "rego",
                    "rule": "file(securitycontacts.rego)",
                    "evals": [
                        {
                            "id": "PR-AZR-ASC-005",
                            "eval": "data.rule.securitycontacts_alerts_to_admins_enabled",
                            "message": "data.rule.securitycontacts_alerts_to_admins_enabled_err",
                            "remediationDescription": "",
                            "remediationFunction": "PR_AZR_ASC_005.py"
                        }
                    ],
                    "tags": [
                        {
                            "cloud": "azure",
                            "compliance": [
                                "CIS",
                                "CSA-CCM",
                                "HIPAA",
                                "ISO 27001",
                                "NIST 800",
                                "PCI-DSS"
                            ],
                            "service": [
                                "Security"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_296"
                    ],
                    "severity": "Medium",
                    "title": "Security Center shoud send security alerts notifications to subscription admins",
                    "description": "This policy will identify security centers which dont have configuration enabled to send security alerts notifications to subscription admins and alert if missing."
                }
            ]
        }
    ]
}