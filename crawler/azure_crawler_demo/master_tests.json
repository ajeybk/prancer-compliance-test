{
    "testSet": [
        {
            "masterTestName": "AZURE_TEST",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "AZURE_TEST_224",
                    "type": "rego",
                    "rule": "file(azure_224.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.ContainerRegistry",
                                "Container",
                                "Container Registry"
                            ]
                        }
                    ],
                    "masterSnapshotId": [
                        "AZRSNP_224"
                    ],
                    "title": "Azure Container Registry using the deprecated not classic registry",
                    "description": "This policy identifies an Azure Container Registry (ACR) that is using the classic SKU. The initial release of the Azure Container Registry (ACR) service that was offered as a classic SKU is being deprecated and will be unavailable after April 2019. As a best practice, upgrade your existing classic registry to a managed registry."
                },
                {
                    "masterTestId": "AZURE_TEST_229",
                    "type": "rego",
                    "rule": "file(azure_network_security_229.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS v1.0 (Azure)-6.2",
                                "CSA CCM v3.0.1-DSI-02",
                                "CSA CCM v3.0.1-IAM-07",
                                "CSA CCM v3.0.1-IVS-06",
                                "CSA CCM v3.0.1-IVS-08",
                                "HIPAA-164.312(e)(2)(i)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "PCI DSS v3.2-1.2.1",
                                "CIS",
                                "CSA",
                                "HIPAA",
                                "NIST",
                                "PCI"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) allows SSH traffic from internet on port 22",
                    "description": "Blocking SSH port 22 will protect users from attacks like Account compromise.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_230",
                    "type": "rego",
                    "rule": "file(azure_network_security_230.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS v1.0 (Azure)-6.1",
                                "CSA CCM v3.0.1-DSI-02",
                                "CSA CCM v3.0.1-IAM-07",
                                "CSA CCM v3.0.1-IVS-06",
                                "CSA CCM v3.0.1-IVS-08",
                                "HIPAA-164.312(e)(2)(i)",
                                "NIST 800-53 Rev4-SC-7 (19)",
                                "NIST 800-53 Rev4-SI-4 (4)",
                                "PCI DSS v3.2-1.2.1",
                                "CIS",
                                "CSA",
                                "HIPAA",
                                "NIST",
                                "PCI"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) allows traffic from internet on port 3389",
                    "description": "Blocking RDP port 3389 will protect users from attacks like account compromise, Denial of service and ransomware.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_231",
                    "type": "rego",
                    "rule": "file(azure_network_security_231.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all TCP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open TCP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_232",
                    "type": "rego",
                    "rule": "file(azure_network_security_232.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all UDP traffic from any source",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to open UDP traffic from any source. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_233",
                    "type": "rego",
                    "rule": "file(azure_network_security_233.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all traffic from Internet on TCP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on TCP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_234",
                    "type": "rego",
                    "rule": "file(azure_network_security_234.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all traffic from Internet on UDP protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on UDP protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_235",
                    "type": "rego",
                    "rule": "file(azure_network_security_235.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure Network Security Group (NSG) dose not having Inbound rule overly permissive to all traffic from Internet on any protocol",
                    "description": "This policy identifies Azure Network Security Groups (NSGs) which are overly permissive to all traffic from Internet on any protocol. A network security group contains a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol. As a best practice, it is recommended to configure NSGs to restrict traffic from known sources, allowing only authorized protocols and ports.",
                    "masterSnapshotId": [
                        "AZRSNP_231"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_284",
                    "type": "rego",
                    "rule": "file(azure_network_peer_284.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Azure virtual network peer is disconnected",
                    "description": "Virtual network peering enables you to connect two Azure virtual networks so that the resources in these networks are directly connected.This policy identifies Azure virtual network peers that are disconnected. Typically, the disconnection happens when a peering configuration is deleted on one virtual network, and the other virtual network reports the peering status as disconnected.",
                    "masterSnapshotId": [
                        "AZRSNP_284"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_6",
                    "type": "rego",
                    "rule": "file(azure_network_security_6.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Network",
                                "Networking"
                            ]
                        }
                    ],
                    "title": "Publicly exposed DB Ports",
                    "description": "DB Servers contain sensitive data and should not be exposed to any direct traffic from internet. This policy checks for the network traffic from internet hitting the DB Servers on their default ports. The DB servers default ports are : Microsoft SQL Server (1433), Oracle (1521), MySQL (3306), Sybase (5000), Postgresql (5432), CouchDB (5984), Redis (6379, 6380), RethinkDB (8080,28015, 29015), CassandraDB (9042), Memcached (11211), MongoDB (27017), DB2 (50000).",
                    "masterSnapshotId": [
                        "AZRSNP_284"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_274",
                    "type": "rego",
                    "rule": "file(azure_274.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Compute",
                                "Virtual Machines"
                            ]
                        }
                    ],
                    "title": "Azure Virtual Machine is assigned to an availability set",
                    "description": "To provide application redundancy during planned or unplanned maintenance events, you can group two or more virtual machines (VMs) in an availability set. An availability set ensures that the VMs are distributed across multiple isolated hardware nodes in a cluster so that only a subset of your VMs are impacted should a hardware or software failure occur on Azure.This policy identifies Azure VMs that are not deployed in an availability set. As a high availability (HA) best practice, deploy your VMs in an availability set.",
                    "masterSnapshotId": [
                        "AZRSNP_274"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_277",
                    "type": "rego",
                    "rule": "file(azure_277.rego)",
                    "eval": "data.rule.rulepass",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "COSTUM"
                            ],
                            "service": [
                                "Microsoft.Compute"
                            ]
                        }
                    ],
                    "title": "Azure disk for VM operating system is encrypted at rest using ADE",
                    "description": "To meet your organizational security or compliance requirement, Azure provides disk encryption at rest using Azure Storage Service Encryption (SSE) and Azure Disk Encryption (ADE). Starting February 2017, SSE is enabled by default for all managed disks. ADE is integrated with Azure Key Vault to help you control, manage, and audit the disk encryption keys and secrets.This policy detects Virtual Machine (VM) OS disks that are not encrypted at rest using ADE. As a best practice, enable ADE for provide volume encryption for the OS disk. For more information, see https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption-overview.",
                    "masterSnapshotId": [
                        "AZRSNP_277"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_301",
                    "type": "rego",
                    "rule": "file(azure_301.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS v1.0 (Azure)-3.1",
                                "CSA CCM v3.0.1-CCC-04",
                                "CSA CCM v3.0.1-EKM-02",
                                "CSA CCM v3.0.1-EKM-03",
                                "CSA CCM v3.0.1-EKM-04",
                                "HIPAA-164.312(e)(2)(ii)",
                                "ISO 27001:2013-A.10.1.2",
                                "ISO 27001:2013-A.14.1.2",
                                "ISO 27001:2013-A.18.1.3",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-13",
                                "NIST 800-53 Rev4-SI-7 (6)",
                                "PCI DSS v3.2-4.1",
                                "PCI DSS v3.2-6.5.3",
                                "CIS",
                                "CSA",
                                "HIPAA",
                                "ISO",
                                "NIST",
                                "PCI"
                            ],
                            "service": [
                                "Microsoft.Storage",
                                "Storage",
                                "Storage Accounts"
                            ]
                        }
                    ],
                    "eval": "data.rule.rulepass",
                    "title": "Storage Accounts without Secure transfer enabled",
                    "description": "The secure transfer option enhances the security of your storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access your storage accounts, you must connect using HTTPs. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When you are using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesnâ€™t support HTTPs for custom domain names, this option is not applied when using a custom domain name.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                },
                {
                    "masterTestId": "AZURE_TEST_302",
                    "type": "rego",
                    "rule": "file(azure_302.rego)",
                    "tags": [
                        {
                            "cloud": "Azure",
                            "compliance": [
                                "CIS v1.0 (Azure)-3.1",
                                "HIPAA-164.312(e)(2)(ii)",
                                "NIST 800-53 Rev4-AC-17 (2)",
                                "NIST 800-53 Rev4-SC-13",
                                "NIST 800-53 Rev4-SI-7 (6)",
                                "PCI DSS v3.2-4.1",
                                "PCI DSS v3.2-6.5.3",
                                "CIS",
                                "HIPAA",
                                "NIST",
                                "PCI"
                            ],
                            "service": [
                                "Microsoft.Storage",
                                "Storage",
                                "Storage Accounts"
                            ]
                        }
                    ],
                    "eval": "data.rule.rulepass",
                    "title": "Storage Accounts without Secure transfer enabled",
                    "description": "Turning on firewall rules for your storage account blocks incoming requests for data by default, unless the requests come from a service that is operating within an Azure Virtual Network (VNet). Requests that are blocked include those from other Azure services, from the Azure portal, from logging and metrics services, and so on.You can grant access to Azure services that operate from within a VNet by allowing the subnet of the service instance. Enable a limited number of scenarios through the Exceptions mechanism described in the following section. To access the Azure portal, you would need to be on a machine within the trusted boundary (either IP or VNet) that you set up.",
                    "masterSnapshotId": [
                        "AZRSNP_301"
                    ]
                }
            ]
        }
    ]
}
